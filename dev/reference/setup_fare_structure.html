<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Setup a fare structure to calculate the monetary costs of trips — setup_fare_structure • r5r</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setup a fare structure to calculate the monetary costs of trips — setup_fare_structure"><meta name="description" content="Creates a basic fare structure that describes how transit fares should be
calculated in travel_time_matrix(), expanded_travel_time_matrix(),
accessibility() and pareto_frontier(). This fare structure can be
manually edited and adjusted to the existing rules in your study area, as
long as they stick to some basic premises. Please see the fare structure vignette for more information."><meta property="og:description" content="Creates a basic fare structure that describes how transit fares should be
calculated in travel_time_matrix(), expanded_travel_time_matrix(),
accessibility() and pareto_frontier(). This fare structure can be
manually edited and adjusted to the existing rules in your study area, as
long as they stick to some basic premises. Please see the fare structure vignette for more information."><meta property="og:image" content="https://ipeagit.github.io/r5r/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r5r</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2.099999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/r5r.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/accessibility.html">Accessibility</a></li>
    <li><a class="dropdown-item" href="../articles/detailed_itineraries.html">Trip planning with detailed_itineraries()</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ - Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/fare_structure.html">Accounting for monetary costs</a></li>
    <li><a class="dropdown-item" href="../articles/isochrones.html">Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/pareto_frontier.html">Trade-offs between travel time and monetary cost</a></li>
    <li><a class="dropdown-item" href="../articles/time_window.html">Using the time_window parameter</a></li>
    <li><a class="dropdown-item" href="../articles/travel_time_matrix.html">Travel time matrices</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/r5r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Setup a fare structure to calculate the monetary costs of trips</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/r5r/blob/master/R/fare_structure.R" class="external-link"><code>R/fare_structure.R</code></a></small>
      <div class="d-none name"><code>setup_fare_structure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a basic fare structure that describes how transit fares should be
calculated in <code><a href="travel_time_matrix.html">travel_time_matrix()</a></code>, <code><a href="expanded_travel_time_matrix.html">expanded_travel_time_matrix()</a></code>,
<code><a href="accessibility.html">accessibility()</a></code> and <code><a href="pareto_frontier.html">pareto_frontier()</a></code>. This fare structure can be
manually edited and adjusted to the existing rules in your study area, as
long as they stick to some basic premises. Please see the fare structure vignette for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_fare_structure</span><span class="op">(</span></span>
<span>  <span class="va">r5r_core</span>,</span>
<span>  <span class="va">base_fare</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"MODE"</span>,</span>
<span>  debug_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug_info <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-r-core">r5r_core<a class="anchor" aria-label="anchor" href="#arg-r-r-core"></a></dt>
<dd><p>An object to connect with the R5 routing engine, created with
<code><a href="setup_r5.html">setup_r5()</a></code>.</p></dd>


<dt id="arg-base-fare">base_fare<a class="anchor" aria-label="anchor" href="#arg-base-fare"></a></dt>
<dd><p>A numeric. A base value used to populate the fare
structure.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A string. Describes how <code>fare_type</code>s (a classification we created
to assign fares to different routes) are distributed among routes.
Possible values are <code>MODE</code>, <code>AGENCY</code> and <code>GENERIC</code>. <code>MODE</code> is used when
the mode is what determines the price of a route (e.g. if all the buses of
a given city cost $5). <code>AGENCY</code> is used when the agency that operates each
route is what determines its price (i.e. when two different routes/modes
operated by a single agency cost the same; note that you can also use
<code>AGENCY_NAME</code>, if the agency_ids listed in your GTFS cannot be easily
interpreted). <code>GENERIC</code> is used when all the routes cost the same. Please
note that this classification can later be edited to better suit your
needs (when, for example, two types of buses cost the same, but one offers
discounts after riding the subway and the other one doesn't), but this
parameter may save you some work.</p></dd>


<dt id="arg-debug-path">debug_path<a class="anchor" aria-label="anchor" href="#arg-debug-path"></a></dt>
<dd><p>Either a path to a <code>.csv</code> file or <code>NULL</code>. When <code>NULL</code> (the
default), fare debugging capabilities are disabled - i.e. there's no way
to check if the fare calculation is correct. When a path is provided,
<code>r5r</code> saves different itineraries and their respective fares to the
specified file. How each itinerary is described is controlled by
<code>debug_info</code>.</p></dd>


<dt id="arg-debug-info">debug_info<a class="anchor" aria-label="anchor" href="#arg-debug-info"></a></dt>
<dd><p>Either a string (when <code>debug_path</code> is a path) or <code>NULL</code>
(the default). Doesn't have any effect if <code>debug_path</code> is <code>NULL</code>. When a
string, accepts the values <code>MODE</code>, <code>ROUTE</code> and <code>MODE_ROUTE</code>. These values
dictates how itinerary information is written to the output. Let's suppose
we have an itinerary composed by two transit legs: first a subway leg
whose route_id is 001, and then a bus legs whose route_id is 007. If
<code>debug_info</code> is <code>MODE</code>, then this itinerary will be described as
<code>SUBWAY|BUS</code>. If <code>ROUTE</code>, as <code>001|007</code>. If <code>MODE_ROUTE</code>, as <code>SUBWAY 001|BUS 007</code>. Please note that the final debug information will contain
not only the itineraries that were in fact used in the itineraries
returned in <code><a href="travel_time_matrix.html">travel_time_matrix()</a></code>, <code><a href="accessibility.html">accessibility()</a></code> and
<code><a href="pareto_frontier.html">pareto_frontier()</a></code>, but all the itineraries that <code>R5</code> checked when
calculating the routes. This imposes a performance penalty when tracking
debug information (but has the positive effect of returning a larger
sample of itineraries, which might help finding some implementation issues
on the fare structure).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A fare structure object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other fare structure:
<code><a href="read_fare_structure.html">read_fare_structure</a>()</code>,
<code><a href="write_fare_structure.html">write_fare_structure</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/r5r" class="external-link">r5r</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/poa"</span>, package <span class="op">=</span> <span class="st">"r5r"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r5r_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_r5.html">setup_r5</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached network.dat from /home/runner/work/_temp/Library/r5r/extdata/poa/network.dat</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span> <span class="op">&lt;-</span> <span class="fu">setup_fare_structure</span><span class="op">(</span><span class="va">r5r_core</span>, base_fare <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to debug fare calculation</span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span> <span class="op">&lt;-</span> <span class="fu">setup_fare_structure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  base_fare <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  debug_path <span class="op">=</span> <span class="st">"fare_debug.csv"</span>,</span></span>
<span class="r-in"><span>  debug_info <span class="op">=</span> <span class="st">"MODE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span><span class="op">$</span><span class="va">debug_settings</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output_file</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fare_debug.csv"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trip_info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MODE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># debugging can be manually turned off by setting output_file to ""</span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span><span class="op">$</span><span class="va">debug_settings</span> <span class="op">&lt;-</span> <span class="st">""</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Saraiva, Rafael H. M. Pereira, Daniel Herszenhut, Carlos Kaue Vieira Braga, Matthew Wigginton Bhagat-Conway, Ipea - Institute for Applied Economic Research, Department of Geography &amp; Planning, University of Toronto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

