<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detailed itineraries between origin-destination pairs — detailed_itineraries • r5r</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detailed itineraries between origin-destination pairs — detailed_itineraries"><meta name="description" content="Returns detailed trip information between origin-destination pairs. The
output includes the waiting and moving time in each trip leg, as well as some
info such as the distance traveled, the routes used and the geometry of each
leg. Please note that this function was originally conceptualized as a trip
planning functionality, similar to other commercial and non-commercial APIs
and apps (e.g. Moovit, Google's Directions API, OpenTripPlanning's
PlannerResource API). Thus, it consumes much more time and memory than the
other (more analytical) routing functions included in the package."><meta property="og:description" content="Returns detailed trip information between origin-destination pairs. The
output includes the waiting and moving time in each trip leg, as well as some
info such as the distance traveled, the routes used and the geometry of each
leg. Please note that this function was originally conceptualized as a trip
planning functionality, similar to other commercial and non-commercial APIs
and apps (e.g. Moovit, Google's Directions API, OpenTripPlanning's
PlannerResource API). Thus, it consumes much more time and memory than the
other (more analytical) routing functions included in the package."><meta property="og:image" content="https://ipeagit.github.io/r5r/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r5r</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2.099999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/r5r.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/accessibility.html">Accessibility</a></li>
    <li><a class="dropdown-item" href="../articles/detailed_itineraries.html">Trip planning with detailed_itineraries()</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ - Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/fare_structure.html">Accounting for monetary costs</a></li>
    <li><a class="dropdown-item" href="../articles/isochrones.html">Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/pareto_frontier.html">Trade-offs between travel time and monetary cost</a></li>
    <li><a class="dropdown-item" href="../articles/time_window.html">Using the time_window parameter</a></li>
    <li><a class="dropdown-item" href="../articles/travel_time_matrix.html">Travel time matrices</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/r5r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Detailed itineraries between origin-destination pairs</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/r5r/blob/master/R/detailed_itineraries.R" class="external-link"><code>R/detailed_itineraries.R</code></a></small>
      <div class="d-none name"><code>detailed_itineraries.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns detailed trip information between origin-destination pairs. The
output includes the waiting and moving time in each trip leg, as well as some
info such as the distance traveled, the routes used and the geometry of each
leg. Please note that this function was originally conceptualized as a trip
planning functionality, similar to other commercial and non-commercial APIs
and apps (e.g. Moovit, Google's Directions API, OpenTripPlanning's
PlannerResource API). Thus, it consumes much more time and memory than the
other (more analytical) routing functions included in the package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detailed_itineraries</span><span class="op">(</span></span>
<span>  <span class="va">r5r_core</span>,</span>
<span>  <span class="va">origins</span>,</span>
<span>  <span class="va">destinations</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"WALK"</span>,</span>
<span>  mode_egress <span class="op">=</span> <span class="st">"WALK"</span>,</span>
<span>  departure_datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_window <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  suboptimal_minutes <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  fare_structure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_fare <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_walk_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_bike_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_car_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_trip_duration <span class="op">=</span> <span class="fl">120L</span>,</span>
<span>  walk_speed <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  bike_speed <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  max_rides <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_lts <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  shortest_path <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all_to_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_geometry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  osm_link_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r-r-core">r5r_core<a class="anchor" aria-label="anchor" href="#arg-r-r-core"></a></dt>
<dd><p>An object to connect with the R5 routing engine, created with
<code><a href="setup_r5.html">setup_r5()</a></code>.</p></dd>


<dt id="arg-origins-destinations">origins, destinations<a class="anchor" aria-label="anchor" href="#arg-origins-destinations"></a></dt>
<dd><p>Either a <code>POINT sf</code> object with WGS84 CRS, or a
<code>data.frame</code> containing the columns <code>id</code>, <code>lon</code> and <code>lat</code>.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>A character vector. The transport modes allowed for access,
transfer and vehicle legs of the trips. Defaults to <code>WALK</code>. Please see
details for other options.</p></dd>


<dt id="arg-mode-egress">mode_egress<a class="anchor" aria-label="anchor" href="#arg-mode-egress"></a></dt>
<dd><p>A character vector. The transport mode used after egress
from the last public transport. It can be either <code>WALK</code>, <code>BICYCLE</code> or
<code>CAR</code>. Defaults to <code>WALK</code>. Ignored when public transport is not used.</p></dd>


<dt id="arg-departure-datetime">departure_datetime<a class="anchor" aria-label="anchor" href="#arg-departure-datetime"></a></dt>
<dd><p>A POSIXct object. Please note that the departure
time only influences public transport legs. When working with public
transport networks, please check the <code>calendar.txt</code> within your GTFS feeds
for valid dates. Please see details for further information on how
datetimes are parsed.</p></dd>


<dt id="arg-time-window">time_window<a class="anchor" aria-label="anchor" href="#arg-time-window"></a></dt>
<dd><p>An integer. The time window in minutes for which <code>r5r</code>
will calculate multiple itineraries departing each minute. Defaults to 10
minutes. If the same sequence of routes appear in different minutes of the
time window, only the fastest of them will be kept in the output. This
happens because the result is not aggregated by percentile, as opposed to
other routing functions in the package. Because of that, the output may
contain trips departing after the specified <code>departure_datetime</code>, but
still within the time window. Please read the time window vignette for
more details on how this argument affects the results of each routing
function: <code><a href="../articles/time_window.html">vignette("time_window", package = "r5r")</a></code>.</p></dd>


<dt id="arg-suboptimal-minutes">suboptimal_minutes<a class="anchor" aria-label="anchor" href="#arg-suboptimal-minutes"></a></dt>
<dd><p>A number. The difference in minutes that each
non-optimal RAPTOR branch can have from the optimal branch without being
disregarded by the routing algorithm. If, for example, users set
<code>suboptimal_minutes = 10</code>, the routing algorithm will consider sub-optimal
routes that arrive up to 10 minutes after the arrival of the optimal one.
This argument emulates the real-life behaviour that makes people want to
take a path that is technically not optimal in terms of travel time, for
example, for some practical reasons (e.g. mode preference, safety, etc).
In practice, the higher this value, the more itineraries will be returned
in the final result.</p></dd>


<dt id="arg-fare-structure">fare_structure<a class="anchor" aria-label="anchor" href="#arg-fare-structure"></a></dt>
<dd><p>A fare structure object, following the convention
set in <code><a href="setup_fare_structure.html">setup_fare_structure()</a></code>. This object describes how transit fares
should be calculated. Please see the fare structure vignette to
understand how this object is structured:
<code><a href="../articles/fare_structure.html">vignette("fare_structure", package = "r5r")</a></code>.</p></dd>


<dt id="arg-max-fare">max_fare<a class="anchor" aria-label="anchor" href="#arg-max-fare"></a></dt>
<dd><p>A number. The maximum value that trips can cost when
calculating the fastest journey between each origin and destination pair.</p></dd>


<dt id="arg-max-walk-time">max_walk_time<a class="anchor" aria-label="anchor" href="#arg-max-walk-time"></a></dt>
<dd><p>An integer. The maximum walking time (in minutes) to
access and egress the transit network, to make transfers within the network
or to complete walk-only trips. Defaults to no restrictions (numeric value
of <code>Inf</code>), as long as <code>max_trip_duration</code> is respected. When routing
transit trips, the max time is considered separately for each leg (e.g. if
you set <code>max_walk_time</code> to 15, you could get trips with an up to 15 minutes
walk leg to reach transit and another up to 15 minutes walk leg to reach
the destination after leaving transit. In walk-only trips, whenever
<code>max_walk_time</code> differs from <code>max_trip_duration</code>, the lowest value is
considered.</p></dd>


<dt id="arg-max-bike-time">max_bike_time<a class="anchor" aria-label="anchor" href="#arg-max-bike-time"></a></dt>
<dd><p>An integer. The maximum cycling time (in minutes) to
access and egress the transit network, to make transfers within the network
or to complete bicycle-only trips. Defaults to no restrictions (numeric
value of <code>Inf</code>), as long as <code>max_trip_duration</code> is respected. When routing
transit trips, the max time is considered separately for each leg (e.g. if
you set <code>max_bike_time</code> to 15, you could get trips with an up to 15 minutes
cycle leg to reach transit and another up to 15 minutes cycle leg to reach
the destination after leaving transit. In bicycle-only trips, whenever
<code>max_bike_time</code> differs from <code>max_trip_duration</code>, the lowest value is
considered.</p></dd>


<dt id="arg-max-car-time">max_car_time<a class="anchor" aria-label="anchor" href="#arg-max-car-time"></a></dt>
<dd><p>An integer. The maximum driving time (in minutes) to
access and egress the transit network. Defaults to no restrictions, as long
as <code>max_trip_duration</code> is respected. The max time is considered separately
for each leg (e.g. if you set <code>max_car_time</code> to 15 minutes, you could
potentially drive up to 15 minutes to reach transit, and up to <em>another</em> 15
minutes to reach the destination after leaving transit). Defaults to <code>Inf</code>,
no limit.</p></dd>


<dt id="arg-max-trip-duration">max_trip_duration<a class="anchor" aria-label="anchor" href="#arg-max-trip-duration"></a></dt>
<dd><p>An integer. The maximum trip duration in minutes.
Defaults to 120 minutes (2 hours).</p></dd>


<dt id="arg-walk-speed">walk_speed<a class="anchor" aria-label="anchor" href="#arg-walk-speed"></a></dt>
<dd><p>A numeric. Average walk speed in km/h. Defaults to 3.6
km/h.</p></dd>


<dt id="arg-bike-speed">bike_speed<a class="anchor" aria-label="anchor" href="#arg-bike-speed"></a></dt>
<dd><p>A numeric. Average cycling speed in km/h. Defaults to 12
km/h.</p></dd>


<dt id="arg-max-rides">max_rides<a class="anchor" aria-label="anchor" href="#arg-max-rides"></a></dt>
<dd><p>An integer. The maximum number of public transport rides
allowed in the same trip. Defaults to 3.</p></dd>


<dt id="arg-max-lts">max_lts<a class="anchor" aria-label="anchor" href="#arg-max-lts"></a></dt>
<dd><p>An integer between 1 and 4. The maximum level of traffic
stress that cyclists will tolerate. A value of 1 means cyclists will only
travel through the quietest streets, while a value of 4 indicates cyclists
can travel through any road. Defaults to 2. Please see details for more
information.</p></dd>


<dt id="arg-shortest-path">shortest_path<a class="anchor" aria-label="anchor" href="#arg-shortest-path"></a></dt>
<dd><p>A logical. Whether the function should only return the
fastest itinerary between each origin and destination pair (the default)
or multiple alternatives.</p></dd>


<dt id="arg-all-to-all">all_to_all<a class="anchor" aria-label="anchor" href="#arg-all-to-all"></a></dt>
<dd><p>A logical. Whether to query routes between the 1st origin
to the 1st destination, then the 2nd origin to the 2nd destination, and so
on (<code>FALSE</code>, the default) or to query routes between all origins to all
destinations (<code>TRUE</code>).</p></dd>


<dt id="arg-n-threads">n_threads<a class="anchor" aria-label="anchor" href="#arg-n-threads"></a></dt>
<dd><p>An integer. The number of threads to use when running the
router in parallel. Defaults to use all available threads (Inf).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical. Whether to show <code>R5</code> informative messages when
running the function. Defaults to <code>FALSE</code> (please note that in such case
<code>R5</code> error messages are still shown). Setting <code>verbose</code> to <code>TRUE</code> shows
detailed output, which can be useful for debugging issues not caught by
<code>r5r</code>.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>A logical. Whether to show a progress counter when running
the router. Defaults to <code>FALSE</code>. Only works when <code>verbose</code> is set to
<code>FALSE</code>, so the progress counter does not interfere with <code>R5</code>'s output
messages. Setting <code>progress</code> to <code>TRUE</code> may impose a small penalty for
computation efficiency, because the progress counter must be synchronized
among all active threads.</p></dd>


<dt id="arg-drop-geometry">drop_geometry<a class="anchor" aria-label="anchor" href="#arg-drop-geometry"></a></dt>
<dd><p>A logical. Whether the output should include the
geometry of each trip leg or not. The default value of <code>FALSE</code> keeps the
geometry column in the result.</p></dd>


<dt id="arg-osm-link-ids">osm_link_ids<a class="anchor" aria-label="anchor" href="#arg-osm-link-ids"></a></dt>
<dd><p>A logical. Whether the output should include additional
columns with the OSM ids of the road segments used along the trip geometry.
Defaults to <code>FALSE</code>. Keep in mind that the <code>osm_id</code> for a road will be
returned even if the route uses a small stretch of the road (e.g. 5m of a
600m street segment). If you want more precision you should use the column
<code>edge_id</code> which returns segments of the exact length used in the trip, and
you can later tie that back to the <code>osm_id</code>.</p></dd>


<dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>Either <code>NULL</code> or a path to an existing directory. When not
<code>NULL</code> (the default), the function will write one <code>.csv</code> file with the
results for each origin in the specified directory. In such case, the
function returns the path specified in this parameter. This parameter is
particularly useful when running on memory-constrained settings because
writing the results directly to disk prevents <code>r5r</code> from loading them to
RAM memory.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>When <code>drop_geometry</code> is <code>FALSE</code>, the function outputs a <code>LINESTRING sf</code> with detailed information on the itineraries between the specified
origins and destinations. When <code>TRUE</code>, the output is a <code>data.table</code>. All
distances are in meters and travel times are in minutes. If <code>output_dir</code>
is not <code>NULL</code>, the function returns the path specified in that parameter,
in which the <code>.csv</code> files containing the results are saved.</p>
    </div>
    <div class="section level2">
    <h2 id="transport-modes">Transport modes<a class="anchor" aria-label="anchor" href="#transport-modes"></a></h2>



<p><code>R5</code> allows for multiple combinations of transport modes. The options
include:</p><ul><li><p><strong>Transit modes:</strong> <code>TRAM</code>, <code>SUBWAY</code>, <code>RAIL</code>, <code>BUS</code>, <code>FERRY</code>, <code>CABLE_CAR</code>,
<code>GONDOLA</code>, <code>FUNICULAR</code>. The option <code>TRANSIT</code> automatically considers all
public transport modes available.</p></li>
<li><p><strong>Non transit modes:</strong> <code>WALK</code>, <code>BICYCLE</code>, <code>CAR</code>, <code>BICYCLE_RENT</code>,
<code>CAR_PARK</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="level-of-traffic-stress-lts-">Level of Traffic Stress (LTS)<a class="anchor" aria-label="anchor" href="#level-of-traffic-stress-lts-"></a></h2>



<p>When cycling is enabled in <code>R5</code> (by passing the value <code>BIKE</code> to either
<code>mode</code> or <code>mode_egress</code>), setting <code>max_lts</code> will allow cycling only on
streets with a given level of danger/stress. Setting <code>max_lts</code> to 1, for
example, will allow cycling only on separated bicycle infrastructure or
low-traffic streets and routing will revert to walking when traversing any
links with LTS exceeding 1. Setting <code>max_lts</code> to 3 will allow cycling on
links with LTS 1, 2 or 3. Routing also reverts to walking if the street
segment is tagged as non-bikable in OSM (e.g. a staircase), independently of
the specified max LTS.</p>
<p>The default methodology for assigning LTS values to network edges is based
on commonly tagged attributes of OSM ways. See more info about LTS in the
original documentation of R5 from Conveyal at
<a href="https://docs.conveyal.com/learn-more/traffic-stress" class="external-link">https://docs.conveyal.com/learn-more/traffic-stress</a>. In summary:</p><ul><li><p><strong>LTS 1</strong>: Tolerable for children. This includes low-speed, low-volume
streets, as well as those with separated bicycle facilities (such as
parking-protected lanes or cycle tracks).</p></li>
<li><p><strong>LTS 2</strong>: Tolerable for the mainstream adult population. This includes
streets where cyclists have dedicated lanes and only have to interact with
traffic at formal crossing.</p></li>
<li><p><strong>LTS 3</strong>: Tolerable for "enthused and confident" cyclists. This includes
streets which may involve close proximity to moderate- or high-speed
vehicular traffic.</p></li>
<li><p><strong>LTS 4</strong>: Tolerable only for "strong and fearless" cyclists. This
includes streets where cyclists are required to mix with moderate- to
high-speed vehicular traffic.</p></li>
</ul><p>For advanced users, you can provide custom LTS values by adding a tag <code>&lt;key = "lts"&gt;</code> to the <code>osm.pbf</code> file.</p>
    </div>
    <div class="section level2">
    <h2 id="datetime-parsing">Datetime parsing<a class="anchor" aria-label="anchor" href="#datetime-parsing"></a></h2>



<p><code>r5r</code> ignores the timezone attribute of datetime objects when parsing dates
and times, using the study area's timezone instead. For example, let's say
you are running some calculations using Rio de Janeiro, Brazil, as your study
area. The datetime <code>as.POSIXct("13-05-2019 14:00:00", format = "%d-%m-%Y %H:%M:%S")</code> will be parsed as May 13th, 2019, 14:00h in
Rio's local time, as expected. But <code>as.POSIXct("13-05-2019 14:00:00", format = "%d-%m-%Y %H:%M:%S", tz = "Europe/Paris")</code> will also be parsed as
the exact same date and time in Rio's local time, perhaps surprisingly,
ignoring the timezone attribute.</p>
    </div>
    <div class="section level2">
    <h2 id="routing-algorithm">Routing algorithm<a class="anchor" aria-label="anchor" href="#routing-algorithm"></a></h2>



<p>The <code>detailed_itineraries()</code> and <code><a href="pareto_frontier.html">pareto_frontier()</a></code> functions use an
<code>R5</code>-specific extension to the McRAPTOR routing algorithm. The
implementation used in <code>detailed_itineraries()</code> allows the router to find
paths that are optimal and less than optimal in terms of travel time, with
some heuristics around multiple access modes, riding the same patterns, etc.
The specific extension to McRAPTOR to do suboptimal path routing is not
documented yet, but a detailed description of base McRAPTOR can be found in
Delling et al (2015). The implementation used in <code><a href="pareto_frontier.html">pareto_frontier()</a></code>, on the
other hand, returns only the fastest trip within a given monetary cutoff,
ignoring slower trips that cost the same. A detailed discussion on the
algorithm can be found in Conway and Stewart (2019).</p><ul><li><p>Delling, D., Pajor, T., &amp; Werneck, R. F. (2015). Round-based public
transit routing. Transportation Science, 49(3), 591-604.
<a href="https://doi.org/10.1287/trsc.2014.0534" class="external-link">doi:10.1287/trsc.2014.0534</a></p></li>
<li><p>Conway, M. W., &amp; Stewart, A. F. (2019). Getting Charlie off the MTA: a
multiobjective optimization method to account for cost constraints in public
transit accessibility metrics. International Journal of Geographical
Information Science, 33(9), 1759-1787. <a href="https://doi.org/10.1080/13658816.2019.1605075" class="external-link">doi:10.1080/13658816.2019.1605075</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other routing:
<code><a href="arrival_travel_time_matrix.html">arrival_travel_time_matrix</a>()</code>,
<code><a href="expanded_travel_time_matrix.html">expanded_travel_time_matrix</a>()</code>,
<code><a href="pareto_frontier.html">pareto_frontier</a>()</code>,
<code><a href="travel_time_matrix.html">travel_time_matrix</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/r5r" class="external-link">r5r</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># build transport network</span></span></span>
<span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/poa"</span>, package <span class="op">=</span> <span class="st">"r5r"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r5r_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_r5.html">setup_r5</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached network.dat from /home/runner/work/_temp/Library/r5r/extdata/poa/network.dat</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load origin/destination points</span></span></span>
<span class="r-in"><span><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"poa_points_of_interest.csv"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inputs</span></span></span>
<span class="r-in"><span><span class="va">departure_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"13-05-2019 14:00:00"</span>,</span></span>
<span class="r-in"><span>  format <span class="op">=</span> <span class="st">"%d-%m-%Y %H:%M:%S"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">det</span> <span class="op">&lt;-</span> <span class="fu">detailed_itineraries</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  origins <span class="op">=</span> <span class="va">points</span><span class="op">[</span><span class="fl">10</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>  destinations <span class="op">=</span> <span class="va">points</span><span class="op">[</span><span class="fl">12</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WALK"</span>, <span class="st">"TRANSIT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  departure_datetime <span class="op">=</span> <span class="va">departure_datetime</span>,</span></span>
<span class="r-in"><span>  max_trip_duration <span class="op">=</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">det</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 5 features and 16 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -51.24094 ymin: -30.05 xmax: -51.19762 ymax: -29.99729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            from_id  from_lat  from_lon                          to_id    to_lat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center -30.04995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center -30.04995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center -30.04995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center -30.04995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center -30.04995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      to_lon option departure_time total_duration total_distance segment mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -51.22875      1       14:09:10           36.2           9460       1 WALK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -51.22875      1       14:09:10           36.2           9460       2 RAIL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -51.22875      1       14:09:10           36.2           9460       3 WALK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -51.22875      1       14:09:10           36.2           9460       4  BUS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -51.22875      1       14:09:10           36.2           9460       5 WALK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   segment_duration wait distance  route                       geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              4.6  0.0      174        LINESTRING (-51.1981 -29.99...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              6.6  1.3     4796 LINHA1 LINESTRING (-51.19763 -29.9...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              5.7  0.0      256        LINESTRING (-51.22827 -30.0...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             10.4  4.4     4083    188 LINESTRING (-51.22926 -30.0...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              3.2  0.0      151        LINESTRING (-51.22949 -30.0...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="stop_r5.html">stop_r5</a></span><span class="op">(</span><span class="va">r5r_core</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> r5r_core has been successfully stopped.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Saraiva, Rafael H. M. Pereira, Daniel Herszenhut, Carlos Kaue Vieira Braga, Matthew Wigginton Bhagat-Conway, Ipea - Institute for Applied Economic Research, Department of Geography &amp; Planning, University of Toronto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

