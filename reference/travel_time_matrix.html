<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate travel time matrix between origin destination pairs — travel_time_matrix • r5r</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate travel time matrix between origin destination pairs — travel_time_matrix"><meta property="og:description" content="Fast computation of travel time estimates between one or multiple origin
destination pairs."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r5r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/r5r.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/calculating_accessibility.html">Calculating and visualizing Accessibility</a>
    </li>
    <li>
      <a href="../articles/calculating_isochrones.html">Calculating and visualizing Isochrones</a>
    </li>
    <li>
      <a href="../articles/detailed_itineraries.html">Planning routes with detailed_itineraries()</a>
    </li>
    <li>
      <a href="../articles/fare_structure.html">Accounting for monetary costs</a>
    </li>
    <li>
      <a href="../articles/pareto_frontier.html">Analyzing the trade-offs between travel time and monetary cost</a>
    </li>
    <li>
      <a href="../articles/time_window.html">Using the time_window parameter</a>
    </li>
    <li>
      <a href="../articles/travel_time_matrix.html">Calculating travel time matrices</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ipeaGIT/r5r/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate travel time matrix between origin destination pairs</h1>
    <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/r5r/tree/master/r-package/R/travel_time_matrix.R" class="external-link"><code>R/travel_time_matrix.R</code></a></small>
    <div class="hidden name"><code>travel_time_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fast computation of travel time estimates between one or multiple origin
destination pairs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">travel_time_matrix</span><span class="op">(</span></span>
<span>  <span class="va">r5r_core</span>,</span>
<span>  <span class="va">origins</span>,</span>
<span>  <span class="va">destinations</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"WALK"</span>,</span>
<span>  mode_egress <span class="op">=</span> <span class="st">"WALK"</span>,</span>
<span>  departure_datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_window <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  percentiles <span class="op">=</span> <span class="fl">50L</span>,</span>
<span>  fare_structure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_fare <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_walk_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_bike_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_car_time <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max_trip_duration <span class="op">=</span> <span class="fl">120L</span>,</span>
<span>  walk_speed <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  bike_speed <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  max_rides <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_lts <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  draws_per_minute <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>r5r_core</dt>
<dd><p>An object to connect with the R5 routing engine, created with
<code><a href="setup_r5.html">setup_r5()</a></code>.</p></dd>


<dt>origins, destinations</dt>
<dd><p>Either a <code>POINT sf</code> object with WGS84 CRS, or a
<code>data.frame</code> containing the columns <code>id</code>, <code>lon</code> and <code>lat</code>.</p></dd>


<dt>mode</dt>
<dd><p>A character vector. The transport modes allowed for access,
transfer and vehicle legs of the trips. Defaults to <code>WALK</code>. Please see
details for other options.</p></dd>


<dt>mode_egress</dt>
<dd><p>A character vector. The transport mode used after egress
from the last public transport. It can be either <code>WALK</code>, <code>BICYCLE</code> or
<code>CAR</code>. Defaults to <code>WALK</code>. Ignored when public transport is not used.</p></dd>


<dt>departure_datetime</dt>
<dd><p>A POSIXct object. Please note that the departure
time only influences public transport legs. When working with public
transport networks, please check the <code>calendar.txt</code> within your GTFS feeds
for valid dates. Please see details for further information on how
datetimes are parsed.</p></dd>


<dt>time_window</dt>
<dd><p>An integer. The time window in minutes for which <code>r5r</code>
will calculate multiple travel time matrices departing each minute.
Defaults to 1 minute. By default, the function returns the result based on
median travel times, but the user can set the <code>percentiles</code> parameter to
extract more results. Please read the time window vignette for more details
on its usage <code><a href="../articles/time_window.html">vignette("time_window", package = "r5r")</a></code></p></dd>


<dt>percentiles</dt>
<dd><p>An integer vector (max length of 5). Specifies the
percentile to use when returning travel time estimates within the given
time window. For example, if the 25th travel time percentile between A and
B is 15 minutes, 25% of all trips taken between these points within the
specified time window are shorter than 15 minutes. Defaults to 50,
returning the median travel time. If a vector with length bigger than 1 is
passed, the output contains an additional column for each percentile
specifying the percentile travel time estimate. each estimate. Due to
upstream restrictions, only 5 percentiles can be specified at a time. For
more details, please see R5 documentation at
<a href="https://docs.conveyal.com/analysis/methodology#accounting-for-variability" class="external-link">https://docs.conveyal.com/analysis/methodology#accounting-for-variability</a>.</p></dd>


<dt>fare_structure</dt>
<dd><p>A fare structure object, following the convention
set in <code><a href="setup_fare_structure.html">setup_fare_structure()</a></code>. This object describes how transit fares
should be calculated. Please see the fare structure vignette to
understand how this object is structured:
<code><a href="../articles/fare_structure.html">vignette("fare_structure", package = "r5r")</a></code>.</p></dd>


<dt>max_fare</dt>
<dd><p>A number. The maximum value that trips can cost when
calculating the fastest journey between each origin and destination pair.</p></dd>


<dt>max_walk_time</dt>
<dd><p>An integer. The maximum walking time (in minutes) to
access and egress the transit network, or to make transfers within the
network. Defaults to no restrictions, as long as <code>max_trip_duration</code> is
respected. The max time is considered separately for each leg (e.g. if
you set <code>max_walk_time</code> to 15, you could potentially walk up to 15 minutes
to reach transit, and up to <em>another</em> 15 minutes to reach the destination
after leaving transit). Defaults to <code>Inf</code>, no limit.</p></dd>


<dt>max_bike_time</dt>
<dd><p>An integer. The maximum cycling time (in minutes) to
access and egress the transit network. Defaults to no restrictions, as long
as <code>max_trip_duration</code> is respected. The max time is considered separately
for each leg (e.g. if you set <code>max_bike_time</code> to 15 minutes, you could
potentially cycle up to 15 minutes to reach transit, and up to <em>another</em> 15
minutes to reach the destination after leaving transit). Defaults to <code>Inf</code>,
no limit.</p></dd>


<dt>max_car_time</dt>
<dd><p>An integer. The maximum driving time (in minutes) to
access and egress the transit network. Defaults to no restrictions, as long
as <code>max_trip_duration</code> is respected. The max time is considered separately
for each leg (e.g. if you set <code>max_car_time</code> to 15 minutes, you could
potentially drive up to 15 minutes to reach transit, and up to <em>another</em> 15
minutes to reach the destination after leaving transit). Defaults to <code>Inf</code>,
no limit.</p></dd>


<dt>max_trip_duration</dt>
<dd><p>An integer. The maximum trip duration in minutes.
Defaults to 120 minutes (2 hours).</p></dd>


<dt>walk_speed</dt>
<dd><p>A numeric. Average walk speed in km/h. Defaults to 3.6
km/h.</p></dd>


<dt>bike_speed</dt>
<dd><p>A numeric. Average cycling speed in km/h. Defaults to 12
km/h.</p></dd>


<dt>max_rides</dt>
<dd><p>An integer. The maximum number of public transport rides
allowed in the same trip. Defaults to 3.</p></dd>


<dt>max_lts</dt>
<dd><p>An integer between 1 and 4. The maximum level of traffic
stress that cyclists will tolerate. A value of 1 means cyclists will only
travel through the quietest streets, while a value of 4 indicates cyclists
can travel through any road. Defaults to 2. Please see details for more
information.</p></dd>


<dt>draws_per_minute</dt>
<dd><p>An integer. The number of Monte Carlo draws to
perform per time window minute when calculating travel time matrices and
when estimating accessibility. Defaults to 5. This would mean 300 draws in
a 60-minute time window, for example. This parameter only affects the
results when the GTFS feeds contain a <code>frequencies.txt</code> table.</p></dd>


<dt>n_threads</dt>
<dd><p>An integer. The number of threads to use when running the
router in parallel. Defaults to use all available threads (Inf).</p></dd>


<dt>verbose</dt>
<dd><p>A logical. Whether to show <code>R5</code> informative messages when
running the function. Defaults to <code>FALSE</code> (please note that in such case
<code>R5</code> error messages are still shown). Setting <code>verbose</code> to <code>TRUE</code> shows
detailed output, which can be useful for debugging issues not caught by
<code>r5r</code>.</p></dd>


<dt>progress</dt>
<dd><p>A logical. Whether to show a progress counter when running
the router. Defaults to <code>FALSE</code>. Only works when <code>verbose</code> is set to
<code>FALSE</code>, so the progress counter does not interfere with <code>R5</code>'s output
messages. Setting <code>progress</code> to <code>TRUE</code> may impose a small penalty for
computation efficiency, because the progress counter must be synchronized
among all active threads.</p></dd>


<dt>output_dir</dt>
<dd><p>Either <code>NULL</code> or a path to an existing directory. When not
<code>NULL</code> (the default), the function will write one <code>.csv</code> file with the
results for each origin in the specified directory. In such case, the
function returns the path specified in this parameter. This parameter is
particularly useful when running estimates on memory-constrained settings,
because writing the results to disk prevents <code>r5r</code> from storing them in
memory.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.table</code> with travel time estimates (in minutes) between
origin and destination pairs. Pairs whose trips couldn't be completed
within the maximum travel time and/or whose origin is too far from the
street network are not returned in the <code>data.table</code>. If <code>output_dir</code> is
not <code>NULL</code>, the function returns the path specified in that parameter, in
which the <code>.csv</code> files containing the results are saved.</p>
    </div>
    <div id="transport-modes">
    <h2>Transport modes</h2>
    


<p><code>R5</code> allows for multiple combinations of transport modes. The options
include:</p><ul><li><p><strong>Transit modes:</strong> <code>TRAM</code>, <code>SUBWAY</code>, <code>RAIL</code>, <code>BUS</code>, <code>FERRY</code>, <code>CABLE_CAR</code>,
<code>GONDOLA</code>, <code>FUNICULAR</code>. The option <code>TRANSIT</code> automatically considers all
public transport modes available.</p></li>
<li><p><strong>Non transit modes:</strong> <code>WALK</code>, <code>BICYCLE</code>, <code>CAR</code>, <code>BICYCLE_RENT</code>,
<code>CAR_PARK</code>.</p></li>
</ul></div>
    <div id="level-of-traffic-stress-lts-">
    <h2>Level of Traffic Stress (LTS)</h2>
    


<p>When cycling is enabled in <code>R5</code> (by passing the value <code>BIKE</code> to either
<code>mode</code> or <code>mode_egress</code>), setting <code>max_lts</code> will allow cycling only on
streets with a given level of danger/stress. Setting <code>max_lts</code> to 1, for
example, will allow cycling only on separated bicycle infrastructure or
low-traffic streets and routing will revert to walking when traversing any
links with LTS exceeding 1. Setting <code>max_lts</code> to 3 will allow cycling on
links with LTS 1, 2 or 3. Routing also reverts to walking if the street
segment is tagged as non-bikable in OSM (e.g. a staircase), independently of
the specified max LTS.</p>
<p>The default methodology for assigning LTS values to network edges is based
on commonly tagged attributes of OSM ways. See more info about LTS in the
original documentation of R5 from Conveyal at
<a href="https://docs.conveyal.com/learn-more/traffic-stress" class="external-link">https://docs.conveyal.com/learn-more/traffic-stress</a>. In summary:</p><ul><li><p><strong>LTS 1</strong>: Tolerable for children. This includes low-speed, low-volume
streets, as well as those with separated bicycle facilities (such as
parking-protected lanes or cycle tracks).</p></li>
<li><p><strong>LTS 2</strong>: Tolerable for the mainstream adult population. This includes
streets where cyclists have dedicated lanes and only have to interact with
traffic at formal crossing.</p></li>
<li><p><strong>LTS 3</strong>: Tolerable for "enthused and confident" cyclists. This includes
streets which may involve close proximity to moderate- or high-speed
vehicular traffic.</p></li>
<li><p><strong>LTS 4</strong>: Tolerable only for "strong and fearless" cyclists. This
includes streets where cyclists are required to mix with moderate- to
high-speed vehicular traffic.</p></li>
</ul><p>For advanced users, you can provide custom LTS values by adding a tag <code>&lt;key = "lts"&gt;</code> to the <code>osm.pbf</code> file.</p>
    </div>
    <div id="datetime-parsing">
    <h2>Datetime parsing</h2>
    


<p><code>r5r</code> ignores the timezone attribute of datetime objects when parsing dates
and times, using the study area's timezone instead. For example, let's say
you are running some calculations using Rio de Janeiro, Brazil, as your study
area. The datetime <code>as.POSIXct("13-05-2019 14:00:00", format = "%d-%m-%Y %H:%M:%S")</code> will be parsed as May 13th, 2019, 14:00h in
Rio's local time, as expected. But <code>as.POSIXct("13-05-2019 14:00:00", format = "%d-%m-%Y %H:%M:%S", tz = "Europe/Paris")</code> will also be parsed as
the exact same date and time in Rio's local time, perhaps surprisingly,
ignoring the timezone attribute.</p>
    </div>
    <div id="routing-algorithm">
    <h2>Routing algorithm</h2>
    


<p>The <code>travel_time_matrix()</code>, <code><a href="expanded_travel_time_matrix.html">expanded_travel_time_matrix()</a></code> and
<code><a href="accessibility.html">accessibility()</a></code> functions use an <code>R5</code>-specific extension to the RAPTOR
routing algorithm (see Conway et al., 2017). This RAPTOR extension uses a
systematic sample of one departure per minute over the time window set by the
user in the 'time_window' parameter. A detailed description of base RAPTOR
can be found in Delling et al (2015). However, whenever the user includes
transit fares inputs to these functions, they automatically switch to use an
<code>R5</code>-specific extension to the McRAPTOR routing algorithm.</p><ul><li><p>Conway, M. W., Byrd, A., &amp; van der Linden, M. (2017). Evidence-based
transit and land use sketch planning using interactive accessibility methods
on combined schedule and headway-based networks. Transportation Research
Record, 2653(1), 45-53. <a href="https://doi.org/10.3141/2653-06" class="external-link">doi:10.3141/2653-06</a></p></li>
<li><p>Delling, D., Pajor, T., &amp; Werneck, R. F. (2015). Round-based public
transit routing. Transportation Science, 49(3), 591-604.
<a href="https://doi.org/10.1287/trsc.2014.0534" class="external-link">doi:10.1287/trsc.2014.0534</a></p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other routing: 
<code><a href="detailed_itineraries.html">detailed_itineraries</a>()</code>,
<code><a href="expanded_travel_time_matrix.html">expanded_travel_time_matrix</a>()</code>,
<code><a href="pareto_frontier.html">pareto_frontier</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/r5r" class="external-link">r5r</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># build transport network</span></span></span>
<span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/poa"</span>, package <span class="op">=</span> <span class="st">"r5r"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r5r_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_r5.html">setup_r5</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached R5 version from /home/runner/work/_temp/Library/r5r/jar/r5-v6.9-all.jar</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached network.dat from /home/runner/work/_temp/Library/r5r/extdata/poa/network.dat</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load origin/destination points</span></span></span>
<span class="r-in"><span><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"poa_points_of_interest.csv"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">departure_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"13-05-2019 14:00:00"</span>,</span></span>
<span class="r-in"><span>  format <span class="op">=</span> <span class="st">"%d-%m-%Y %H:%M:%S"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ttm</span> <span class="op">&lt;-</span> <span class="fu">travel_time_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  origins <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  destinations <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WALK"</span>, <span class="st">"TRANSIT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  departure_datetime <span class="op">=</span> <span class="va">departure_datetime</span>,</span></span>
<span class="r-in"><span>  max_trip_duration <span class="op">=</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ttm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from_id               to_id travel_time_p50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: public_market       public_market               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: public_market bus_central_station              13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: public_market    gasometer_museum              10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: public_market santa_casa_hospital              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: public_market            townhall               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: public_market     piratini_palace              17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using a larger time window</span></span></span>
<span class="r-in"><span><span class="va">ttm</span> <span class="op">&lt;-</span> <span class="fu">travel_time_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  origins <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  destinations <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WALK"</span>, <span class="st">"TRANSIT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  departure_datetime <span class="op">=</span> <span class="va">departure_datetime</span>,</span></span>
<span class="r-in"><span>  time_window <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  max_trip_duration <span class="op">=</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ttm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from_id               to_id travel_time_p50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: public_market       public_market               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: public_market bus_central_station              14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: public_market    gasometer_museum              13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: public_market santa_casa_hospital              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: public_market            townhall               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: public_market     piratini_palace              17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># selecting different percentiles</span></span></span>
<span class="r-in"><span><span class="va">ttm</span> <span class="op">&lt;-</span> <span class="fu">travel_time_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  origins <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  destinations <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WALK"</span>, <span class="st">"TRANSIT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  departure_datetime <span class="op">=</span> <span class="va">departure_datetime</span>,</span></span>
<span class="r-in"><span>  time_window <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  max_trip_duration <span class="op">=</span> <span class="fl">60</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ttm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from_id               to_id travel_time_p25 travel_time_p50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: public_market       public_market               0               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: public_market bus_central_station              13              14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: public_market    gasometer_museum              12              13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: public_market santa_casa_hospital              15              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: public_market            townhall               3               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: public_market     piratini_palace              17              17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    travel_time_p75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:              14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:              14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:              17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use a fare structure and set a max fare to take monetary constraints into</span></span></span>
<span class="r-in"><span><span class="co"># account</span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_fare_structure.html">read_fare_structure</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_path</span>, <span class="st">"fares/fares_poa.zip"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ttm</span> <span class="op">&lt;-</span> <span class="fu">travel_time_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  origins <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  destinations <span class="op">=</span> <span class="va">points</span>,</span></span>
<span class="r-in"><span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WALK"</span>, <span class="st">"TRANSIT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  departure_datetime <span class="op">=</span> <span class="va">departure_datetime</span>,</span></span>
<span class="r-in"><span>  fare_structure <span class="op">=</span> <span class="va">fare_structure</span>,</span></span>
<span class="r-in"><span>  max_fare <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  max_trip_duration <span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ttm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          from_id               to_id travel_time_p50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: public_market       public_market               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: public_market bus_central_station              13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: public_market    gasometer_museum              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: public_market santa_casa_hospital              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: public_market            townhall               3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: public_market     piratini_palace              17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="stop_r5.html">stop_r5</a></span><span class="op">(</span><span class="va">r5r_core</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> r5r_core has been successfully stopped.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcus Saraiva, Rafael H. M. Pereira, Daniel Herszenhut, Carlos Kaue Vieira Braga, Matthew Wigginton Conway, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

