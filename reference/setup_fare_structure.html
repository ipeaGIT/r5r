<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Setup a fare structure to calculate the monetary costs of trips — setup_fare_structure • r5r</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Setup a fare structure to calculate the monetary costs of trips — setup_fare_structure"><meta property="og:description" content='Creates a basic fare structure that describes how transit fares should be
calculated in travel_time_matrix(), expanded_travel_time_matrix(),
accessibility() and pareto_frontier(). This fare structure can be
manually edited and adjusted to the existing rules in your study area, as
long as they stick to some basic premises. Please see fare structure
vignette for more information on how the fare structure works:
vignette("fare_structure", package = "r5r").'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r5r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/r5r.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/calculating_accessibility.html">Calculating and visualizing Accessibility</a>
    </li>
    <li>
      <a href="../articles/calculating_isochrones.html">Calculating and visualizing Isochrones</a>
    </li>
    <li>
      <a href="../articles/detailed_itineraries.html">Planning routes with detailed_itineraries()</a>
    </li>
    <li>
      <a href="../articles/fare_structure.html">Accounting for monetary costs</a>
    </li>
    <li>
      <a href="../articles/pareto_frontier.html">Analyzing the trade-offs between travel time and monetary cost</a>
    </li>
    <li>
      <a href="../articles/time_window.html">Using the time_window parameter</a>
    </li>
    <li>
      <a href="../articles/travel_time_matrix.html">Calculating travel time matrices</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ipeaGIT/r5r/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Setup a fare structure to calculate the monetary costs of trips</h1>
    <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/r5r/tree/master/r-package/R/fare_structure.R" class="external-link"><code>R/fare_structure.R</code></a></small>
    <div class="hidden name"><code>setup_fare_structure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a basic fare structure that describes how transit fares should be
calculated in <code><a href="travel_time_matrix.html">travel_time_matrix()</a></code>, <code><a href="expanded_travel_time_matrix.html">expanded_travel_time_matrix()</a></code>,
<code><a href="accessibility.html">accessibility()</a></code> and <code><a href="pareto_frontier.html">pareto_frontier()</a></code>. This fare structure can be
manually edited and adjusted to the existing rules in your study area, as
long as they stick to some basic premises. Please see fare structure
vignette for more information on how the fare structure works:
<code><a href="../articles/fare_structure.html">vignette("fare_structure", package = "r5r")</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_fare_structure</span><span class="op">(</span></span>
<span>  <span class="va">r5r_core</span>,</span>
<span>  <span class="va">base_fare</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"MODE"</span>,</span>
<span>  debug_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug_info <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>r5r_core</dt>
<dd><p>An object to connect with the R5 routing engine, created with
<code><a href="setup_r5.html">setup_r5()</a></code>.</p></dd>


<dt>base_fare</dt>
<dd><p>A numeric. A base value used to populate the fare
structure.</p></dd>


<dt>by</dt>
<dd><p>A string. Describes how <code>fare_type</code>s (a classification we created
to assign fares to different routes) are distributed among routes.
Possible values are <code>MODE</code>, <code>AGENCY</code> and <code>GENERIC</code>. <code>MODE</code> is used when
the mode is what determines the price of a route (e.g. if all the buses of
a given city cost $5). <code>AGENCY</code> is used when the agency that operates each
route is what determines its price (i.e. when two different routes/modes
operated by a single agency cost the same; note that you can also use
<code>AGENCY_NAME</code>, if the agency_ids listed in your GTFS cannot be easily
interpreted). <code>GENERIC</code> is used when all the routes cost the same. Please
note that this classification can later be edited to better suit your
needs (when, for example, two types of buses cost the same, but one offers
discounts after riding the subway and the other one doesn't), but this
parameter may save you some work.</p></dd>


<dt>debug_path</dt>
<dd><p>Either a path to a <code>.csv</code> file or <code>NULL</code>. When <code>NULL</code> (the
default), fare debugging capabilities are disabled - i.e. there's no way
to check if the fare calculation is correct. When a path is provided,
<code>r5r</code> saves different itineraries and their respective fares to the
specified file. How each itinerary is described is controlled by
<code>debug_info</code>.</p></dd>


<dt>debug_info</dt>
<dd><p>Either a string (when <code>debug_path</code> is a path) or <code>NULL</code>
(the default). Doesn't have any effect if <code>debug_path</code> is <code>NULL</code>. When a
string, accepts the values <code>MODE</code>, <code>ROUTE</code> and <code>MODE_ROUTE</code>. These values
dictates how itinerary information is written to the output. Let's suppose
we have an itinerary composed by two transit legs: first a subway leg
whose route_id is 001, and then a bus legs whose route_id is 007. If
<code>debug_info</code> is <code>MODE</code>, then this itinerary will be described as
<code>SUBWAY|BUS</code>. If <code>ROUTE</code>, as <code>001|007</code>. If <code>MODE_ROUTE</code>, as <code>SUBWAY 001|BUS 007</code>. Please note that the final debug information will contain
not only the itineraries that were in fact used in the itineraries
returned in <code><a href="travel_time_matrix.html">travel_time_matrix()</a></code>, <code><a href="accessibility.html">accessibility()</a></code> and
<code><a href="pareto_frontier.html">pareto_frontier()</a></code>, but all the itineraries that <code>R5</code> checked when
calculating the routes. This imposes a performance penalty when tracking
debug information (but has the positive effect of returning a larger
sample of itineraries, which might help finding some implementation issues
on the fare structure).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A fare structure object.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other fare structure: 
<code><a href="read_fare_structure.html">read_fare_structure</a>()</code>,
<code><a href="write_fare_structure.html">write_fare_structure</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/r5r" class="external-link">r5r</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/poa"</span>, package <span class="op">=</span> <span class="st">"r5r"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r5r_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="setup_r5.html">setup_r5</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached R5 version from /home/runner/work/_temp/Library/r5r/jar/r5-v6.9-all.jar</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using cached network.dat from /home/runner/work/_temp/Library/r5r/extdata/poa/network.dat</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span> <span class="op">&lt;-</span> <span class="fu">setup_fare_structure</span><span class="op">(</span><span class="va">r5r_core</span>, base_fare <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to debug fare calculation</span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span> <span class="op">&lt;-</span> <span class="fu">setup_fare_structure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">r5r_core</span>,</span></span>
<span class="r-in"><span>  base_fare <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  debug_path <span class="op">=</span> <span class="st">"fare_debug.csv"</span>,</span></span>
<span class="r-in"><span>  debug_info <span class="op">=</span> <span class="st">"MODE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span><span class="op">$</span><span class="va">debug_settings</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $output_file</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fare_debug.csv"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $trip_info</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MODE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># debugging can be manually turned off by setting output_file to ""</span></span></span>
<span class="r-in"><span><span class="va">fare_structure</span><span class="op">$</span><span class="va">debug_settings</span> <span class="op">&lt;-</span> <span class="st">""</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcus Saraiva, Rafael H. M. Pereira, Daniel Herszenhut, Carlos Kaue Vieira Braga, Matthew Wigginton Conway, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

